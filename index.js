const deck = [{
    suit: "spades",
    type: "ace",
    value: 1,
    image: "./cards/ace_of_spades.png",
    visable: true
}, 
{
    suit: "spades",
    type: "two",
    value: 2,
    image: "./cards/2_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "three",
    value: 3,
    image: "./cards/3_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "four",
    value: 4,
    image: "./cards/4_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "five",
    value: 5,
    image: "./cards/5_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "six",
    value: 6,
    image: "./cards/6_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "seven",
    value: 7,
    image: "./cards/7_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "eight",
    value: 8,
    image: "./cards/8_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "nine",
    value: 9,
    image: "./cards/9_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "ten",
    value: 10,
    image: "./cards/10_of_spades.png",
    visable: true
},
{
    suit: "spades",
    type: "jack",
    value: 11,
    image: "./cards/jack_of_spades2.png",
    visable: true
},
{
    suit: "spades",
    type: "queen",
    value: 12,
    image: "./cards/queen_of_spades2.png",
    visable: true
},
{
    suit: "spades",
    type: "king",
    value: 13,
    image: "./cards/king_of_spades2.png",
    visable: true
},
{
    suit: "hearts",
    type: "ace",
    value: 1,
    image: "./cards/ace_of_hearts.png",
    visable: true
}, 
{
    suit: "hearts",
    type: "two",
    value: 2,
    image: "./cards/2_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "three",
    value: 3,
    image: "./cards/3_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "four",
    value: 4,
    image: "./cards/4_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "five",
    value: 5,
    image: "./cards/5_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "six",
    value: 6,
    image: "./cards/6_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "seven",
    value: 7,
    image: "./cards/7_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "eight",
    value: 8,
    image: "./cards/8_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "nine",
    value: 9,
    image: "./cards/9_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "ten",
    value: 10,
    image: "./cards/10_of_hearts.png",
    visable: true
},
{
    suit: "hearts",
    type: "jack",
    value: 11,
    image: "./cards/jack_of_hearts2.png",
    visable: true
},
{
    suit: "hearts",
    type: "queen",
    value: 12,
    image: "./cards/queen_of_hearts2.png",
    visable: true
},
{
    suit: "hearts",
    type: "king",
    value: 13,
    image: "./cards/king_of_hearts2.png",
    visable: true
},
{
    suit: "diamonds",
    type: "ace",
    value: 1,
    image: "./cards/ace_of_diamonds.png",
    visable: true
}, 
{
    suit: "diamonds",
    type: "two",
    value: 2,
    image: "./cards/2_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "three",
    value: 3,
    image: "./cards/3_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "four",
    value: 4,
    image: "./cards/4_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "five",
    value: 5,
    image: "./cards/5_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "six",
    value: 6,
    image: "./cards/6_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "seven",
    value: 7,
    image: "./cards/7_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "eight",
    value: 8,
    image: "./cards/8_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "nine",
    value: 9,
    image: "./cards/9_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "ten",
    value: 10,
    image: "./cards/10_of_diamonds.png",
    visable: true
},
{
    suit: "diamonds",
    type: "jack",
    value: 11,
    image: "./cards/jack_of_diamonds2.png",
    visable: true
},
{
    suit: "diamonds",
    type: "queen",
    value: 12,
    image: "./cards/queen_of_diamonds2.png",
    visable: true
},
{
    suit: "diamonds",
    type: "king",
    value: 13,
    image: "./cards/king_of_diamonds2.png",
    visable: true
},
{
    suit: "clubs",
    type: "ace",
    value: 1,
    image: "./cards/ace_of_clubs.png",
    visable: true
}, 
{
    suit: "clubs",
    type: "two",
    value: 2,
    image: "./cards/2_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "three",
    value: 3,
    image: "./cards/3_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "four",
    value: 4,
    image: "./cards/4_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "five",
    value: 5,
    image: "./cards/5_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "six",
    value: 6,
    image: "./cards/6_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "seven",
    value: 7,
    image: "./cards/7_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "eight",
    value: 8,
    image: "./cards/8_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "nine",
    value: 9,
    image: "./cards/9_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "ten",
    value: 10,
    image: "./cards/10_of_clubs.png",
    visable: true
},
{
    suit: "clubs",
    type: "jack",
    value: 11,
    image: "./cards/jack_of_clubs2.png",
    visable: true
},
{
    suit: "clubs",
    type: "queen",
    value: 12,
    image: "./cards/queen_of_clubs2.png",
    visable: true
},
{
    suit: "clubs",
    type: "king",
    value: 13,
    image: "./cards/king_of_clubs2.png",
    visable: true
}
];
const solGame ={
    pickedGame: "",
    indexofCards: 0,
    numberofDeals: 1,
    numberOfCardsPicked: 0,
    idOfFirstCard: "",
    idOfSecondCard: "",
    deckCount: 0,
    deck: shuffle(deck)
}
window.addEventListener("load", function() {
    const disDeck = document.getElementById("displayDeck");
    const pyr = document.getElementById("pyramidPlay");
    let games = [{"war": disWar}, {"pyramid": disPyrSol}];
    //displayCard(disDeck, deck);
    //let shuffled = shuffle(deck);
    let select;
    //displayCard(disDeck,shuffled);
    const form = document.querySelector("form");

    form.addEventListener('submit', function(event){
        select = document.querySelector("input[name=chooseGame]:checked").value;
        form.hidden=true;
        event.preventDefault();
        console.log(select);
        
    });

    console.log(select);
    document.getElementById("choice").innerHTML=`You chose ${select}`;
    disPyrSol(pyr);
    playSol();
});

function disWar(){}
function disPyrSol(pyr){
    let showPyr = pyr;
    showPyr.id = "pyr";
    let count = 0;
    //create a row for each section of cards
    let imgDiv = document.getElementById("imgContainer");
    for (let x = 0; x<8; x++){
        let y = 0;
        
        //row.id = 'row';
        while(y<x){
            let img = document.createElement("img");
            img.src = solGame.deck[count].image;
            img.alt = `${solGame.deck[count].type} of ${solGame.deck[count].suit}`;
            img.id = "place"+count;
            imgDiv.appendChild(img);
            //row.innerHTML = x;
            y++;
            count ++;
            if(count<21)
                solGame.deck.visable = false;
            solGame.deckCount = count;
        }
        //showPyr.appendChild(row);
        const para = document.createElement("p");
        //para.innerHTML = 'hi';
        imgDiv.appendChild(para);
        showPyr.appendChild(imgDiv);
        console.log(solGame.deckCount);
        
    }
    
}
function playSol(){
    let flag = startGame();
    let drawDeck = document.getElementById("drawDeck");
    let img = document.createElement("img");
    let img2 = document.createElement("img");
    img2.id = "nextCard";
    img.src = "./cards/cardBack.png";
    img.id = "drawCard";
    drawDeck.appendChild(img);
    drawDeck.appendChild(img2);
    document.addEventListener('click', function(event) {
        let where = event.target.id;
        cardClicked(where);
        //console.log(`I clicked ${where}`);
     });
}

function startGame(){
    return true;
}

function cardClicked(id){
    let card = document.getElementById(id);
    if(id.indexOf("place") !=-1 || id==="nextCard"){//need to lock out certain cards.
        if(card.style.borderColor === "green"){//already selected
            if(solGame.numberOfCardsPicked===2){
                card.style.border = "none";
                if(id===solGame.idOfFirstCard){
                    solGame.idOfFirstCard = "";
                }else{
                    solGame.idOfSecondCard = "";
                }
                solGame.numberOfCardsPicked--;
            }else if(solGame.numberOfCardsPicked===1){
                card.style.border = "none";
                if(id===solGame.idOfFirstCard){
                    solGame.idOfFirstCard = "";
                }else{
                    solGame.idOfSecondCard = "";
                }
                solGame.numberOfCardsPicked--;
            }
        }else{//first time being picked
            if(solGame.numberOfCardsPicked===0){
                card.style.border = "solid";
                card.style.borderColor = "green"; 
                solGame.idOfFirstCard = id;
                solGame.numberOfCardsPicked++;
                isThirteen(id);
            }else if(solGame.numberOfCardsPicked===1){
                card.style.border = "solid";
                card.style.borderColor = "green"; 
                solGame.idOfSecondCard = id;
                solGame.numberOfCardsPicked++;
                isThirteen(solGame.idOfFirstCard, solGame.idOfSecondCard);//got to handle what happends when cards are removed
            }else{
                alert("two cards are already selected.");
            }
            
        } 
    }
    if(id ==="drawCard"){//this does not work right now. 
        let drawDeck = document.getElementById("drawDeck");
        let img = document.getElementById("nextCard");
        if(img.style.visibility==="hidden"){
            console.log("im hidden and need to come out");
            img.style.visibility = 'visible';
        }
                
        img.src = solGame.deck[solGame.deckCount].image;
        img.alt = `${solGame.deck[solGame.deckCount].type} of ${solGame.deck[solGame.deckCount].suit}`;
        //img.id = `${solGame.deck[solGame.deckCount].type} of ${solGame.deck[solGame.deckCount].suit}`;
        solGame.deckCount++;
    }
}

function isThirteen(first, second = ""){
    //chedk to see if it is a king first
    let card1 = document.getElementById(first);
    let name1 = card1.id;
    let king = card1.alt
    if(second==="" && king.indexOf("king")===-1){
        return;
    }
    if (second==="" && king.indexOf("king")!=-1){
        card1.style.visibility = "hidden";
        solGame.numberOfCardsPicked--;
    }else{
        //get value of the cards
        let card2 = document.getElementById(second);
        let name2 = card2.id;
        console.log(name1, name2, solGame.deckCount);
        let place1, place2;
        if (name1 ==="nextCard")
            place1 = solGame.deck[solGame.deckCount-1].value;
        if (name2 ==="nextCard")
            place2 = solGame.deck[solGame.deckCount-1].value;
        if(name1.indexOf("place")!=-1){
            place1 = solGame.deck[Number(name1.replace("place",""))].value;
            console.log(place1);
        }
        if(name2.indexOf("place")!=-1){
            place2 = solGame.deck[Number(name2.replace("place",""))].value; 
        }
        console.log(place1 , place2);
        if(place1+place2===13){
            card1.style.visibility = "hidden";
            card2.style.visibility = "hidden";
            solGame.numberOfCardsPicked=0;
        }else{
            return;
        }
        //
    }
    //check to see if the 2 cards sum to 13 then if they are visible, if they are delete them

}


function getGame(select){
    return games[select];
}

function displayCard(disDeck, deck){
    let display = disDeck;
    for(let x =0; x<deck.length; x++){
     let img = document.createElement("img");
        img.src = deck[x].image;
        display.appendChild(img);
    }
}

function shuffle(deck){
    let tempDeck = deck;
    for (let x = 0; x<365; x++){
        let random1 = Math.floor(Math.random()*deck.length);
        let random2 = Math.floor(Math.random()*deck.length);
        let temp;
        
        temp = tempDeck[random1];
        tempDeck[random1] = tempDeck[random2];
        tempDeck[random2] = temp;

    }
    return tempDeck;
}
